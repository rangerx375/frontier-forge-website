<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apply Now | Frontier Forge Institute</title>
    <meta name="description" content="Apply for The Forge - a selective field leadership course for young men ages 13-17.">
    <link rel="icon" type="image/png" href="assets/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Source+Serif+4:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Override section opacity for this page */
        section, .apply-page, .apply-hero, .application-section, .footer {
            opacity: 1 !important;
            transform: none !important;
        }
        .main-nav {
            animation: none !important;
            opacity: 1 !important;
        }
        .apply-page {
            padding-top: 100px;
            min-height: 100vh;
            background: var(--color-cream);
        }
        .apply-hero {
            background: var(--color-charcoal);
            padding: var(--spacing-xl) var(--spacing-md);
            text-align: center;
            color: var(--color-off-white);
        }
        .apply-hero h1 {
            color: var(--color-white);
            margin-bottom: var(--spacing-sm);
        }
        .apply-hero p {
            max-width: 700px;
            margin: 0 auto;
            font-size: 1.1rem;
        }
        .process-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            max-width: 900px;
            margin: var(--spacing-lg) auto 0;
        }
        .process-step {
            text-align: center;
            padding: var(--spacing-md);
            background: rgba(255,255,255,0.05);
            position: relative;
            border-radius: 16px;
            transition: all 0.3s ease;
        }
        .process-step:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-5px);
        }
        .step-number {
            font-family: var(--font-display);
            font-size: 2.5rem;
            color: var(--color-copper);
            display: block;
            margin-bottom: var(--spacing-xs);
        }
        .process-step h3 {
            color: var(--color-white);
            font-size: 1rem;
            margin-bottom: var(--spacing-xs);
        }
        .process-step p {
            font-size: 0.9rem;
            color: var(--color-light-gray);
            margin: 0;
        }
        .application-section {
            padding: var(--spacing-xl) var(--spacing-md);
        }
        .form-container {
            max-width: 750px;
            margin: 0 auto;
            background: var(--color-white);
            padding: var(--spacing-xl);
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border-radius: 20px;
        }
        .form-section {
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-lg);
            border-bottom: 1px solid #e0e0e0;
        }
        .form-section:last-of-type {
            border-bottom: none;
            margin-bottom: var(--spacing-md);
        }
        .form-section-title {
            font-family: var(--font-display);
            font-size: 1.35rem;
            letter-spacing: 0.1em;
            color: var(--color-forest);
            margin-bottom: var(--spacing-md);
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .form-section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(180deg, #ff4400, #ff6b00, #ffaa00);
            border-radius: 2px;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }
        .form-group {
            margin-bottom: var(--spacing-md);
        }
        .form-group:last-child {
            margin-bottom: 0;
        }
        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--color-charcoal);
        }
        .form-group label .required {
            color: var(--color-rust);
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-family: var(--font-body);
            font-size: 1rem;
            background: #fafafa;
            transition: all 0.3s ease;
        }
        .form-group input:hover,
        .form-group select:hover,
        .form-group textarea:hover {
            border-color: #ccc;
            background: #fff;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--color-copper);
            background: #fff;
            box-shadow: 0 0 0 4px rgba(184, 115, 51, 0.1);
        }
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #aaa;
        }
        .form-group small {
            display: block;
            margin-top: 0.5rem;
            color: var(--color-medium-gray);
            font-size: 0.85rem;
        }
        .deposit-notice {
            background: linear-gradient(135deg, var(--color-forest) 0%, #2d4a3e 100%);
            color: var(--color-off-white);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            border-radius: 16px;
            border-left: 4px solid var(--color-copper);
        }
        .deposit-notice h3 {
            color: var(--color-white);
            font-size: 1.1rem;
            margin-bottom: var(--spacing-sm);
        }
        .deposit-notice p {
            margin: 0;
            font-size: 0.95rem;
        }
        .deposit-notice .amount {
            font-family: var(--font-display);
            font-size: 2rem;
            color: var(--color-copper);
            display: block;
            margin: var(--spacing-sm) 0;
        }
        .deposit-notice ul {
            list-style: none;
            margin-top: var(--spacing-sm);
        }
        .deposit-notice li {
            padding: 0.25rem 0;
            padding-left: 1.5rem;
            position: relative;
        }
        .deposit-notice li::before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--color-copper);
        }
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: #f8f8f8;
            border-radius: 12px;
            transition: background 0.3s ease;
        }
        .checkbox-group:hover {
            background: #f0f0f0;
        }
        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 0.1rem;
            accent-color: var(--color-rust);
            cursor: pointer;
        }
        .checkbox-group label {
            margin: 0;
            font-weight: 400;
            cursor: pointer;
            line-height: 1.5;
        }
        .submit-btn {
            width: 100%;
            padding: 1.25rem;
            background: linear-gradient(135deg, #ff4400 0%, #ff6b00 50%, #ffaa00 100%);
            color: var(--color-white);
            font-family: var(--font-display);
            font-size: 1.25rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(255, 68, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        .submit-btn:hover::before {
            left: 100%;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(255, 68, 0, 0.4);
        }
        .submit-btn:disabled {
            background: var(--color-gray);
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        .form-footer {
            text-align: center;
            margin-top: var(--spacing-md);
            color: var(--color-medium-gray);
            font-size: 0.9rem;
        }
        .interview-info {
            background: rgba(139, 69, 19, 0.1);
            border-left: 4px solid var(--color-rust);
            padding: var(--spacing-md);
            margin-top: var(--spacing-lg);
        }
        .interview-info h3 {
            color: var(--color-rust);
            font-size: 1rem;
            margin-bottom: var(--spacing-sm);
        }
        .interview-info p {
            margin: 0;
            font-size: 0.95rem;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-display);
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-size: 0.9rem;
        }
        .back-link:hover {
            color: var(--color-copper);
        }
        #confirmation {
            display: none;
            text-align: center;
            padding: var(--spacing-xl);
        }
        #confirmation.show {
            display: block;
        }
        #confirmation h2 {
            color: var(--color-forest);
            margin-bottom: var(--spacing-sm);
        }
        #confirmation > p {
            color: var(--color-medium-gray);
            margin-bottom: var(--spacing-lg);
        }
        #confirmation .checkmark-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: var(--color-white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin: 0 auto var(--spacing-md);
            box-shadow: 0 10px 30px rgba(34, 197, 94, 0.3);
        }
        .next-steps-container {
            display: flex;
            justify-content: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }
        .step-card {
            background: #f5f5f5;
            padding: var(--spacing-md);
            border-radius: 12px;
            text-align: center;
            flex: 1;
            max-width: 160px;
            opacity: 0.5;
        }
        .step-card.completed {
            background: #dcfce7;
            opacity: 1;
        }
        .step-card.active {
            background: linear-gradient(135deg, #fff7ed, #ffedd5);
            border: 2px solid var(--color-copper);
            opacity: 1;
        }
        .step-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--color-medium-gray);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--spacing-xs);
            font-family: var(--font-display);
            font-size: 1.1rem;
        }
        .step-card.completed .step-icon {
            background: #22c55e;
        }
        .step-card.active .step-icon {
            background: linear-gradient(135deg, #ff4400, #ff6b00);
        }
        .step-card h3 {
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
        }
        .step-card p {
            font-size: 0.75rem;
            color: var(--color-medium-gray);
            margin: 0;
        }
        .step-card.completed p { color: #16a34a; }
        .step-card.active p { color: var(--color-copper); }
        .calendly-section {
            background: var(--color-charcoal);
            padding: var(--spacing-md);
            margin-top: var(--spacing-md);
            text-align: center;
        }
        .calendly-section h3 {
            color: var(--color-white);
            margin-bottom: var(--spacing-sm);
        }
        .calendly-section p {
            color: var(--color-light-gray);
            margin-bottom: var(--spacing-md);
        }
        .calendly-btn {
            display: inline-block;
            padding: 1.25rem 2.5rem;
            background: linear-gradient(135deg, #ff4400 0%, #ff6b00 50%, #ffaa00 100%);
            color: var(--color-white);
            font-family: var(--font-display);
            font-size: 1.2rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            text-decoration: none;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(255, 68, 0, 0.4);
            transition: all 0.3s ease;
        }
        .calendly-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 68, 0, 0.5);
            color: var(--color-white);
        }
        .redirect-notice {
            background: var(--color-charcoal);
            padding: var(--spacing-lg);
            border-radius: 16px;
            text-align: center;
            margin: var(--spacing-lg) 0;
        }
        .redirect-notice p {
            color: var(--color-light-gray);
            margin-bottom: var(--spacing-sm);
        }
        .redirect-timer {
            font-size: 0.9rem;
            margin-bottom: var(--spacing-md) !important;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img src="assets/logo.png" alt="Frontier Forge Institute">
            </a>
            <ul class="nav-links">
                <li><a href="index.html#mission">Mission</a></li>
                <li><a href="index.html#course">The Course</a></li>
                <li><a href="index.html#schedule">Schedule</a></li>
                <li><a href="index.html#founder">Founder</a></li>
                <li><a href="apply.html" class="nav-cta">Enroll Now</a></li>
            </ul>
            <button class="mobile-menu-btn" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <div class="apply-page">
        <!-- Hero -->
        <section class="apply-hero">
            <h1>Apply to The Forge</h1>
            <p>Complete this application to begin the enrollment process. All applicants will be interviewed to ensure The Forge is the right fit.</p>

            <div class="process-steps">
                <div class="process-step">
                    <span class="step-number">1</span>
                    <h3>Submit Application</h3>
                    <p>Complete form & $250 deposit</p>
                </div>
                <div class="process-step">
                    <span class="step-number">2</span>
                    <h3>Schedule Interview</h3>
                    <p>20-30 minute call</p>
                </div>
                <div class="process-step">
                    <span class="step-number">3</span>
                    <h3>Admission Decision</h3>
                    <p>We'll notify you within 48 hours</p>
                </div>
                <div class="process-step">
                    <span class="step-number">4</span>
                    <h3>Complete Enrollment</h3>
                    <p>Pay remaining balance</p>
                </div>
            </div>
        </section>

        <!-- Application Form -->
        <section class="application-section">
            <div class="form-container">
                <a href="index.html" class="back-link">← Back to Home</a>

                <form id="applicationForm">
                    <!-- Parent/Guardian Information -->
                    <div class="form-section">
                        <h2 class="form-section-title">Parent/Guardian Information</h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Parent/Guardian Name <span class="required">*</span></label>
                                <input type="text" name="parent_name" required>
                            </div>
                            <div class="form-group">
                                <label>Relationship to Student <span class="required">*</span></label>
                                <select name="relationship" required>
                                    <option value="">Select...</option>
                                    <option value="Father">Father</option>
                                    <option value="Mother">Mother</option>
                                    <option value="Legal Guardian">Legal Guardian</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email Address <span class="required">*</span></label>
                                <input type="email" name="parent_email" required>
                            </div>
                            <div class="form-group">
                                <label>Phone Number <span class="required">*</span></label>
                                <input type="tel" name="parent_phone" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Mailing Address <span class="required">*</span></label>
                            <input type="text" name="address" placeholder="Street Address" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <input type="text" name="city" placeholder="City" required>
                            </div>
                            <div class="form-group">
                                <input type="text" name="state" placeholder="State" required>
                            </div>
                            <div class="form-group">
                                <input type="text" name="zip" placeholder="ZIP Code" required>
                            </div>
                        </div>
                    </div>

                    <!-- Student Information -->
                    <div class="form-section">
                        <h2 class="form-section-title">Student Information</h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Student's Full Name <span class="required">*</span></label>
                                <input type="text" name="student_name" required>
                            </div>
                            <div class="form-group">
                                <label>Date of Birth <span class="required">*</span></label>
                                <input type="date" name="student_dob" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Age (as of August 2, 2025) <span class="required">*</span></label>
                                <input type="number" name="student_age" min="13" max="17" required>
                                <small>Must be between 13-17 years old</small>
                            </div>
                            <div class="form-group">
                                <label>Student's Email (if applicable)</label>
                                <input type="email" name="student_email">
                            </div>
                        </div>
                    </div>

                    <!-- Health & Medical Information -->
                    <div class="form-section">
                        <h2 class="form-section-title">Health & Medical Information</h2>
                        <p style="color: var(--color-medium-gray); margin-bottom: var(--spacing-md); font-size: 0.95rem;">This information helps us ensure your son's safety and wellbeing during the course. All information is kept confidential.</p>

                        <div class="form-group">
                            <label>Known Allergies</label>
                            <textarea name="allergies" placeholder="List any food allergies, medication allergies, environmental allergies (bee stings, pollen, etc.), or write 'None'"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Current Medications</label>
                            <textarea name="medications" placeholder="List any medications currently being taken, dosage, and frequency, or write 'None'"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Medical Conditions or Health Issues</label>
                            <textarea name="health_conditions" placeholder="Asthma, diabetes, heart conditions, seizures, mental health considerations, etc., or write 'None'"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Recent Injuries or Physical Limitations</label>
                            <textarea name="injuries" placeholder="Any recent injuries, surgeries, or physical limitations we should be aware of, or write 'None'"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Dietary Restrictions</label>
                            <textarea name="dietary" placeholder="Any dietary restrictions or special dietary needs, or write 'None'"></textarea>
                        </div>
                    </div>

                    <!-- Additional Information -->
                    <div class="form-section">
                        <h2 class="form-section-title">Additional Information</h2>
                        <div class="form-group">
                            <label>Why is your son interested in The Forge? <span class="required">*</span></label>
                            <textarea name="interest_reason" required placeholder="Tell us what drew you to this program and what you hope your son will gain from it."></textarea>
                        </div>
                        <div class="form-group">
                            <label>How did you hear about Frontier Forge Institute?</label>
                            <select name="referral_source">
                                <option value="">Select...</option>
                                <option value="Chuck Holton / The Hot Zone">Chuck Holton / The Hot Zone</option>
                                <option value="Social Media">Social Media</option>
                                <option value="Friend/Family Referral">Friend/Family Referral</option>
                                <option value="Church">Church</option>
                                <option value="Web Search">Web Search</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Anything else we should know?</label>
                            <textarea name="additional_info" placeholder="Any additional information that would help us get to know your son better."></textarea>
                        </div>
                    </div>

                    <!-- Emergency Contact -->
                    <div class="form-section">
                        <h2 class="form-section-title">Emergency Contact</h2>
                        <p style="color: var(--color-medium-gray); margin-bottom: var(--spacing-md); font-size: 0.95rem;">Please provide an alternate emergency contact (someone other than yourself).</p>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Emergency Contact Name <span class="required">*</span></label>
                                <input type="text" name="emergency_name" required>
                            </div>
                            <div class="form-group">
                                <label>Relationship <span class="required">*</span></label>
                                <input type="text" name="emergency_relationship" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Emergency Contact Phone <span class="required">*</span></label>
                            <input type="tel" name="emergency_phone" required>
                        </div>
                    </div>

                    <!-- Deposit Information -->
                    <div class="deposit-notice">
                        <h3>Application Deposit</h3>
                        <span class="amount">$250</span>
                        <p>This deposit is required to complete your application and schedule an interview.</p>
                        <ul>
                            <li><strong>Fully refundable</strong> if your son is not admitted</li>
                            <li>Applied toward total tuition if accepted</li>
                            <li>Non-refundable only after admission is confirmed</li>
                        </ul>
                    </div>

                    <!-- Acknowledgments -->
                    <div class="form-section">
                        <h2 class="form-section-title">Acknowledgments</h2>
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="ack_interview" name="ack_interview" required>
                                <label for="ack_interview">I understand that all applicants must complete an interview before admission is granted. <span class="required">*</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="ack_deposit" name="ack_deposit" required>
                                <label for="ack_deposit">I understand the $250 deposit is refundable if my son is not admitted, but becomes non-refundable upon acceptance. <span class="required">*</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="ack_accurate" name="ack_accurate" required>
                                <label for="ack_accurate">I certify that all information provided is accurate and complete to the best of my knowledge. <span class="required">*</span></label>
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">Submit Application & Pay $250 Deposit</button>

                    <p class="form-footer">After submitting, you'll be directed to schedule your interview.</p>
                </form>

                <!-- Confirmation (shown after submission) -->
                <div id="confirmation">
                    <div class="checkmark-circle">✓</div>
                    <h2>Application Received</h2>
                    <p>Thank you for applying to Frontier Forge Institute.</p>

                    <div class="next-steps-container">
                        <div class="step-card completed">
                            <div class="step-icon">✓</div>
                            <h3>Application Submitted</h3>
                            <p>Complete</p>
                        </div>
                        <div class="step-card active">
                            <div class="step-icon">2</div>
                            <h3>Pay & Schedule Interview</h3>
                            <p>Redirecting...</p>
                        </div>
                    </div>

                    <div class="redirect-notice">
                        <p>Redirecting you to schedule your interview and pay the $250 deposit...</p>
                        <p class="redirect-timer">If not redirected in 3 seconds, click below:</p>
                        <a href="https://calendly.com/holtocw/forge-30min-interview" target="_blank" class="calendly-btn">Schedule Interview & Pay Deposit</a>
                    </div>

                    <div class="interview-info">
                        <h3>What to Expect</h3>
                        <p>During the interview, we'll discuss your son's goals and ensure The Forge is the right fit. Both the parent and student should be available. You'll receive an admission decision within 48 hours.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <img src="assets/logo.png" alt="Frontier Forge Institute" class="footer-logo">
            <p class="tagline">"Be watchful, stand firm in the faith, act like men, be strong."</p>
            <p class="scripture-ref">— 1 Corinthians 16:13</p>
            <p class="motto"><strong>Forging Leaders of Tomorrow</strong></p>
            <div class="footer-links">
                <a href="privacy.html">Privacy Policy</a>
                <span>|</span>
                <a href="terms.html">Terms of Service</a>
            </div>
            <p class="copyright">&copy; 2025 Frontier Forge Institute. All rights reserved.</p>
        </div>
    </footer>

    <script>
    // Vercel serverless function
    const GOOGLE_SHEETS_WEBHOOK = '/api/submit';

    // Calendly link (has payment built in)
    const CALENDLY_LINK = 'https://calendly.com/holtocw/forge-30min-interview';

    document.getElementById('applicationForm').addEventListener('submit', async function(e) {
        e.preventDefault();

        const form = e.target;
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;

        // Disable button and show loading
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';

        // Collect form data
        const formData = new FormData(form);
        const data = {
            timestamp: new Date().toISOString(),
            parent_name: formData.get('parent_name'),
            relationship: formData.get('relationship'),
            parent_email: formData.get('parent_email'),
            parent_phone: formData.get('parent_phone'),
            address: formData.get('address'),
            city: formData.get('city'),
            state: formData.get('state'),
            zip: formData.get('zip'),
            student_name: formData.get('student_name'),
            student_dob: formData.get('student_dob'),
            student_age: formData.get('student_age'),
            student_email: formData.get('student_email') || 'N/A',
            allergies: formData.get('allergies') || 'None',
            medications: formData.get('medications') || 'None',
            health_conditions: formData.get('health_conditions') || 'None',
            injuries: formData.get('injuries') || 'None',
            dietary: formData.get('dietary') || 'None',
            interest_reason: formData.get('interest_reason'),
            referral_source: formData.get('referral_source') || 'Not specified',
            additional_info: formData.get('additional_info') || 'None',
            emergency_name: formData.get('emergency_name'),
            emergency_relationship: formData.get('emergency_relationship'),
            emergency_phone: formData.get('emergency_phone'),
            deposit_status: 'Pending'
        };

        try {
            // Send to Google Sheets
            await fetch(GOOGLE_SHEETS_WEBHOOK, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            // Store application data
            localStorage.setItem('ffi_application', JSON.stringify(data));

            // Show confirmation
            form.style.display = 'none';
            document.getElementById('confirmation').classList.add('show');

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Auto-redirect to Calendly after 3 seconds
            setTimeout(() => {
                window.location.href = CALENDLY_LINK;
            }, 3000);

        } catch (error) {
            console.error('Error:', error);
            alert('There was an error. Please try again or contact us at holtocw@gmail.com');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        }
    });

    // Mobile menu
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    const navLinks = document.querySelector('.nav-links');
    if (mobileMenuBtn && navLinks) {
        mobileMenuBtn.addEventListener('click', function() {
            navLinks.classList.toggle('active');
        });
    }

    // AUTO-SAVE FORM DATA
    (function() {
        const appForm = document.getElementById('applicationForm');
        if (!appForm) return;

        const STORAGE_KEY = 'ffi_form_draft';
        const formInputs = appForm.querySelectorAll('input, select, textarea');

        // Load saved data on page load
        try {
            const savedData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            formInputs.forEach(input => {
                if (!input.name) return;
                if (input.type === 'checkbox') {
                    input.checked = savedData[input.name] === true;
                } else if (savedData[input.name] !== undefined) {
                    input.value = savedData[input.name];
                }
            });
        } catch(e) {
            console.log('Could not load saved form data');
        }

        // Save function
        function saveFormData() {
            try {
                const data = {};
                formInputs.forEach(input => {
                    if (!input.name) return;
                    data[input.name] = input.type === 'checkbox' ? input.checked : input.value;
                });
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            } catch(e) {
                console.log('Could not save form data');
            }
        }

        // Save on input (text fields) and change (selects, checkboxes)
        formInputs.forEach(input => {
            input.addEventListener('input', saveFormData);
            input.addEventListener('change', saveFormData);
        });

        // Clear draft after successful submission
        appForm.addEventListener('submit', () => {
            localStorage.removeItem(STORAGE_KEY);
        });
    })();

        </script>
</body>
</html>
